function A = assemble_P1(grid, local_assem, Q)  N = length(grid.nodes);  A = sparse(N,N);    B = basis(1);    for n = 1:length(grid.elements(1,:))    F = grid.elements(1:3,n);    S = [];    for k = F'      S = [S, grid.nodes(1:2,k)];    end    A_loc = local_assem(S,B,Q);    i = reshape(repmat(F,1,3),[1,9]);    j = reshape(repmat(F',3,1),[1,9]);        A = A + sparse(i,j, reshape(A_loc, [1,9]),N,N);   endend